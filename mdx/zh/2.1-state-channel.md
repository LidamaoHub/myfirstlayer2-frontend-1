# 2.1 原型机：状态通道

假设 Alice 经常在一家咖啡店消费，如果每次买一杯 5 美元的咖啡，都需要支付 0.5 美元的手续费，这也太痛苦了。那么假如 Alice 和咖啡店能达成共识，每次买咖啡时付给咖啡店一张签了名的欠条，一段时间后咖啡店攒了足够多的欠条，将欠条算好总金额一次性兑现，这样交易成本就可以大幅降低，对双方都有利。这种思路就是最早的二层网络，也就是状态通道的原理。

状态通道使用了多签技术 <sup>[1]</sup>，允许两个个体之间提前存入一笔资金锁定在智能合约中，建立一个内部通道，然后双方可以在通道内进行多笔小额转账，速度极快，成本极低，再在一段时间后用转账证明一次性提款。状态通道也是比特币的 Lightning Network（闪电网络），以太坊的 Raiden Network（雷电网络）背后的底层技术。

<MdxImg src="https://cdn.myfirst.io/layer2/assets/2.1.1.gif" alt="Single Channel Raiden Network.gif" /> 

在雷电网络中，用户除了在通道内快速转账，还能借助多个节点的中转，向其他没有直接连接的账户发送资金。雷电网络节点越多，整个网络能处理交易的规模也将越大，实现有效扩容。
 
<MdxImg src="https://cdn.myfirst.io/layer2/assets/2.1.2.gif" alt="Multi-Channel Raiden Network.gif" /> 

状态通道技术本质上是使用了**中心化的节点**，用户在链上质押一笔较大额的资金，然后在链下用签了名的“欠条”进行付款，积攒了一定量的“欠条”之后，任何一方都可以选择关闭通道进行结算。链上的智能合约只认可同时拥有双方签名的转账信息，Alice 和咖啡店都拥有自己的签名，再加上“欠条”上对方的签名，才能凑齐签名**通过多签验证**，因此无法提取不属于自己的资金。

但这样做产生了 2 个新的问题：

1. Alice 和咖啡店之间攒“欠条”的约定仅适合于最简单的转账交易，去中心化金融要实现的交易比转账复杂得多，那么**想要实现更复杂的交易要怎么办呢**？为了解决这个问题，引出了**侧链**方案。
2. Alice 可以给咖啡店发送资金，若超市与咖啡店有通道，也可以借助咖啡店向超市发送资金，但是**如何给未参与雷电网络的个体发送资金呢**？这个问题，则引出了 **Plasma** 方案。

&nbsp; 
## 注释及拓展阅读
<sup>[1]</sup> 多签技术（Multi-sig）即多重签名技术，是指需要多个授权方共同授权才能完成交易，提高了交易的安全性和可靠性。如公司财库的资金要求三人之中的至少两人签名（2/3）才能动用，状态通道中则要求同时拥有双方的签名（2/2）才能生效，多签也允许出现更多 n/m 的授权条件。

<GithubAvatar owner='lxdao-official' repo='myfirstlayer2-frontend' path='mdx/zh/2.1-state-channel.md' />

<EditChapter url='https://github.com/lxdao-official/myfirstlayer2-frontend/blob/main/mdx/zh/2.1-state-channel.md' />
